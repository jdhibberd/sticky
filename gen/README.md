# Codegen

Often the best way to create a maintainable and verifiable codebase is to automatically generate parts of that codebase using code _prompts_ from other parts of the codebase. The alternatives are typically to write and maintain lots of boilerplate code by hand, or use complicated logic to infer behaviour dynamically at runtime.

- Each _codegen_ is a module (in the `gen` project dir) that is run at compile-time to automatically generate a module for use in another project's codebase (e.g. `backend`).
- All codegens are automatically run by the build scripts of other projects, as appropriate.
- A module that has been automatically generated by a codegen has the `.gen.[ts|js]` extension. These files should never be modified by hand, since any changes will be overwritten the next time the codegen is run.
- All generated code (despite being technically a derived artefact) should be checked into source control because it's necessary for the codebase to be considered _valid_ (i.e. passes the various format/lint/type checks).
- All generated code should be expressed in TypeScript. It will then be transpiled into JavaScript by the host project during its build phase.
- Before committing a codegen, run the formatter against the generated module to ensure there are no warnings, e.g.
  ```
  cd backend
  npx prettier . --check
  ```
- Each codegen should be able to perform the code analysis it needs without having to transpile a codebase (which would be slow). Limit analysis to file system queries, regex, etc.
